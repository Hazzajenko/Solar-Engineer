<ng-container *ngIf="project$ | async; let project">
  <ng-container *ngIf="gridState$ | async; let gridState">
    <ng-container *ngIf="blocks$ | async; let blocks">
      <div cdkDropListGroup class="project-design-container">
        <div *ngFor="let n of numSequence(20); let row = index" class="row">
          <div *ngFor="let n of numSequence(20); let col = index" class="col">
            <!--            <ng-container
                          *ngrxLet="row | getGridNumber: col; let locationNumber"
                        >-->
            <ng-container
              *ngrxLet="row | getGridString: col; let locationString"
            >
              <!--              {{ row }}|{{ col }}-->
              <!--              {{ locationString }}-->
              <div
                (cdkDropListDropped)="
                  gridDrag.gridDrop($event, project, blocks)
                "
                (click)="
                  gridCell.cellAction(
                    locationString,
                    gridState,
                    project,
                    blocks
                  )
                "
                [id]="locationString"
                cdkDropList
                class="drop-zone"
                id="hello"
              >
                <!--                {{ locationString }}-->
                <ng-container
                  *ngIf="blocks | findBlockNumber: locationString; let block"
                >
                  <ng-container [ngSwitch]="block.model">
                    <ng-container *ngSwitchCase="5">
                      <ng-container *ngIf="panels$ | async; let panels">
                        <ng-container
                          *ngIf="
                            panels | findPanelLocation: block.location!;
                            let panel
                          "
                        >
                          <div
                            (contextmenu)="onRightClick($event, panel)"
                            *ngIf="panel.location === locationString"
                            [cdkDragData]="panel"
                            [matTooltip]="'Location = ' + panel.location"
                            [style.border]="'2px solid ' + panel.color"
                            cdkDrag
                            class="panel"
                            matTooltipPosition="right"
                          >
                            {{ panel.location }}
                          </div>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngSwitchCase="6">
                      <ng-container *ngIf="cables$ | async; let cables">
                        <ng-container
                          *ngIf="
                            cables | findCableLocation: block.location!;
                            let cable
                          "
                        >
                          <div
                            (contextmenu)="onRightClick($event, cable)"
                            *ngIf="cable.location === locationString"
                            [cdkDragData]="cable"
                            [matTooltip]="'Location = ' + cable.location"
                            [style.border]="'2px solid ' + cable.color"
                            cdkDrag
                            class="panel"
                            matTooltipPosition="right"
                          >
                            {{ cable.location }}
                          </div>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>
</ng-container>
<div
  [matMenuTriggerFor]="rightMenu"
  [style.left]="menuTopLeftPosition.x"
  [style.top]="menuTopLeftPosition.y"
  style="visibility: hidden; position: fixed"
></div>

<mat-menu #rightMenu="matMenu" class="custom-menu">
  <ng-template let-item="item" matMenuContent>
    <ng-container [ngSwitch]="item.model">
      <ng-container *ngSwitchCase="5">
        <label>{{ item.name }}</label>
        <ul style="list-style: none">
          <li>Panel Id: {{ item.id }}</li>
          <li>Inverter Id: {{ item["inverter_id"] }}</li>
          <li>Tracker Id: {{ item["tracker_id"] }}</li>
          <li>String Id: {{ item["string_id"] }}</li>
        </ul>
        <button (click)="click()" mat-menu-item>Add</button>
        <button mat-menu-item>Edit</button>
        <button (click)="deletePanel(item)" mat-menu-item>Delete</button>
      </ng-container>
      <ng-container *ngSwitchCase="6">
        <ul style="list-style: none">
          <li>Cable Id: {{ item.id }}</li>
          <li>Size: {{ item["size"] }}</li>
          <li>Location: {{ item["location"] }}</li>
        </ul>
        <button (click)="click()" mat-menu-item>Add</button>
        <button mat-menu-item>Edit</button>
        <button mat-menu-item>Delete</button>
      </ng-container>
    </ng-container>
  </ng-template>
  <!--  <ng-template let-panel="panel" matMenuContent>
      <ng-container *ngIf="panel">
        <label>{{ panel.name }}</label>
        <ul style="list-style: none">
          <li>Panel Id: {{ panel.id }}</li>
          <li>Inverter Id: {{ panel["inverter_id"] }}</li>
          <li>Tracker Id: {{ panel["tracker_id"] }}</li>
          <li>String Id: {{ panel["string_id"] }}</li>
        </ul>
        <button (click)="click()" mat-menu-item>Add</button>
        <button mat-menu-item>Edit</button>
        <button (click)="deletePanel(panel)" mat-menu-item>Delete</button>
      </ng-container>
    </ng-template>

    <ng-template let-cable="cable" matMenuContent>
      <ng-container *ngIf="cable">
        &lt;!&ndash;    <label>{{ cable["size"] }}</label>&ndash;&gt;
        <label>{{ cable.size }}</label>
        <ul style="list-style: none">
          <li>Cable Id: {{ cable.id }}</li>
          <li>Size: {{ cable["size"] }}</li>
          <li>Location: {{ cable["location"] }}</li>
        </ul>
        <button (click)="click()" mat-menu-item>Add</button>
        <button mat-menu-item>Edit</button>
        <button mat-menu-item>Delete</button>
      </ng-container>
    </ng-template>-->
</mat-menu>
