<ng-container *ngIf="componentState$ | async as state">
  <div
    style="width: 32px; height: 32px"
    class="flex content-center items-center justify-center whitespace-pre-wrap"
  >
    <!--      <app-panel-rotation *ngIf='panel.rotation' class='pointer-events-none'
                              [setRotation]='panel.rotation'></app-panel-rotation>-->
    <!--      <app-panel-link
            [isNegativeLink]='panelNg.isSelectedNegativeTo'
            [isPositiveLink]='panelNg.isSelectedPositiveTo'
            class='pointer-events-none z-20 relative left-2'
          ></app-panel-link>-->
    <ng-container [ngSwitch]="state.rotation">
      <ng-container *ngSwitchCase="0">
        <svg viewBox="0 0 100 100" class="pointer-events-none relative">
          <path
            class="z-10 fill-none stroke-slate-800 stroke-[8px] dark:stroke-gray-400"
            d="
                        M 30, 0
                        V 100
                        "
          />
          <path
            class="z-10 fill-none stroke-slate-800 stroke-[8px] dark:stroke-gray-400"
            d="
                        M 70, 0
                        V 100
                        "
          />
        </svg>
      </ng-container>
      <ng-container *ngSwitchCase="1">
        <svg viewBox="0 0 100 100" class="pointer-events-none relative">
          <path
            class="z-10 fill-none stroke-slate-800 stroke-[8px] dark:stroke-gray-400"
            d="
                        M 0, 30
                        H 100
                        "
          />
          <path
            class="z-10 fill-none stroke-slate-800 stroke-[8px] dark:stroke-gray-400"
            d="
                        M 0, 70
                        H 100
                        "
          />
        </svg>
      </ng-container>
    </ng-container>

    <ng-container>
      <div
        appPanelDirective
        [state]="state"
        bind-attr.id="state.id"
        bind-attr.blockId="state.id"
        bind-attr.location="state.location"
        bind-attr.blockLocation="state.location"
        (contextmenu)="onRightClick($event, state)"
        [cdkDragData]="state"
        [ngStyle]="{
          height: state.rotation === 0 ? '18px' : '23px',
          width: state.rotation === 0 ? '23px' : '18px'
        }"
        cdkDrag
        class="panel absolute block flex content-center items-center justify-center border border-black hover:bg-red-500 dark:border-gray-400"
      >
        <ng-container *ngIf="state.stringSelected === 'Selected'; else stringNotSelected">
          <ng-container *ngIf="state.selected === 'NotSelected' && !state.selectedPanelPath">
            <div class="pointer-events-none relative bottom-2.5" *ngIf="state.panelPath">
              {{ state.panelPath.link + ":" + state.panelPath.count }}
            </div>
          </ng-container>
          <ng-container *ngIf="state.selected === 'NotSelected' && state.selectedPanelPath">
            <div class="relative">
              {{ state.selectedPanelPath.count }}
            </div>
          </ng-container>
          <ng-container *ngIf="state.selected === 'SingleSelected' && state.selectedPanelPath">
            <div class="relative">
              {{ state.selectedPanelPath.count }}
            </div>
          </ng-container>
        </ng-container>
        <ng-template #stringNotSelected>
          <ng-container *ngIf="!state.panelPath">
            <div class="pointer-events-none relative bottom-2 text-xs" *ngIf="state.stringName">
              <span *ngIf="state.stringName !== 'undefined'">
                {{ state.stringName }}
              </span>
            </div>
          </ng-container>
        </ng-template>
      </div>
    </ng-container>
  </div>
</ng-container>

<div
  [matMenuTriggerFor]="rightMenu"
  [style.left]="menuTopLeftPosition.x"
  [style.top]="menuTopLeftPosition.y"
  style="visibility: hidden; position: fixed"
></div>

<mat-menu #rightMenu="matMenu">
  <ng-template matMenuContent let-state="state">
    <app-panel-menu class="right-click-menu bg-white" [panelComponentState]="state" />
    <!--    [panelNg]="(panelNg$ | async)!"-->
  </ng-template>
</mat-menu>
<!--</ng-container>-->
