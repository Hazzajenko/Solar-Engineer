<ng-container *ngIf="user">
	<div class="flex-none p-6 text-center">
		<span class="relative inline-block">
			<img
				[src]="user.photoUrl"
				alt="{{ user.displayName }} profile picture"
				class="mx-auto h-16 w-16 rounded-full"
				height="64"
				width="64"
			/>
			<span
				*ngIf="user.isOnline"
				class="absolute right-0 top-0 block h-1.5 w-1.5 rounded-full bg-green-400 ring-2 ring-white"
			></span>
		</span>
		<h2 class="mt-3 font-semibold text-gray-900">{{ user.displayName }}</h2>
		<p class="text-sm leading-6 text-gray-500">{{ user.userName }}</p>
	</div>
	<div class="flex flex-auto flex-col justify-between p-6">
		<dl class="grid grid-cols-1 gap-x-6 gap-y-3 text-sm text-gray-700">
			<dt class="col-end-1 font-semibold text-gray-900">Last Active</dt>
			<dd>{{ user.lastActiveTime | timeDifferenceFromNow }}</dd>
			<dt class="col-end-1 font-semibold text-gray-900">Member Since</dt>
			<dd class="truncate">
				<a class="underline">{{ user.registeredAtTime | standaloneDate }}</a>
			</dd>
			<dt class="col-end-1 font-semibold text-gray-900">UserName</dt>
			<dd class="truncate">
				<a class="underline">{{ user.userName }}</a>
			</dd>
		</dl>
		<ng-container *ngIf="user.isFriend; then friends; else notFriends" />
		<ng-template #notFriends>
			<button
				(click)="sendFriendRequest()"
				class="mt-6 w-full rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
				type="button"
			>
				Send Friend Request
			</button>
		</ng-template>
		<ng-template #friends>
			<div class="flex space-x-2 mt-6">
				<button
					(click)="openUserMenu()"
					class="group inline-flex items-center rounded-md px-3 py-2 text-sm bg-white font-semibold text-gray-600 hover:text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
					type="button"
				>
					<svg-input
						class="group-hover:text-gray-700"
						inputClass="h-5 w-5"
						svgName="SvgCog8Tooth"
					/>
				</button>
				<button
					class="w-full rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
					type="button"
				>
					Send message
				</button>
			</div>
		</ng-template>
	</div>
</ng-container>

<ng-template #dialogWarning let-data="data">
	<dialog-warning-template-input (closeDialog)="closeChildOverlay()" [data]="data" />
</ng-template>

<ng-template #userContextMenu>
	<dialog-backdrop-template-component (backdropClick)="closeMenu()" disableCloseDialog>
		<div class="top-10 w-1/2 min-w-fit h-3/4 overflow-y-auto p-4">
			<div>
				<div class="flex flex-col items-start justify-center mb-4 pr-4">
					<h5
						class="inline-flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200"
						id="drawer-label"
					>
						User {{ user.displayName }} Options
					</h5>
				</div>
				<div class="p-2">
					<div class="flex flex-col items-start justify-center text-sm">
						<ng-container *ngIf="user.isFriend; then friendTemplate; else notFriendTemplate" />
						<ng-template #friendTemplate>
							<button
								class="cursor-default flex relative hover:bg-gray-200 my-1 py-1 rounded-md w-full items-center justify-between"
								matRipple
								type="button"
							>
								<svg-input class="scale-90" svgName="SvgChatBubbleLeft" />
								<label class="select-none ml-1 font-medium text-gray-900">Message</label>
							</button>
							<button
								(click)="invitingToProject.set(!invitingToProject())"
								class="cursor-default flex relative hover:bg-gray-200 my-1 py-1 rounded-md w-full items-center justify-between"
								matRipple
								type="button"
							>
								<svg-input class="scale-90" svgName="SvgEnvelope" />
								<label class="select-none ml-1 font-medium text-gray-900">Invite to Project</label>
							</button>
							<ng-container *ngIf="invitingToProject()">
								<div
									*ngFor="let project of projectsThatFriendIsNotIn()"
									class="group hover:bg-gray-100 flex items-center justify-between"
								>
									<div
										(click)="openInviteToProjectDialog(project)"
										class="group flex items-center justify-center"
									>
										<span
											[ngStyle]="{
												'background-color': project.colour,
												'border-color': project.colour
											}"
											class="w-4 h-4 rounded ml-3"
										></span>
										<div class="flex flex-col items-center justify-center">
											<a
												class="flex items-center px-4 py-2 text-sm text-gray-700 group-hover:text-gray-600 dark:hover:bg-gray-600 dark:hover:text-white"
												role="menuitem"
												tabindex="-1"
											>
												<svg-input class="mr-1 group-hover:text-gray-600" svgName="SvgUserPlus" />
												{{ project.name }}
											</a>
										</div>
									</div>
								</div>
							</ng-container>
							<button
								(click)="openRemoveFriendDialog()"
								class="cursor-default flex relative hover:bg-gray-200 my-1 py-1 rounded-md w-full items-center justify-between"
								matRipple
								type="button"
							>
								<svg-input class="scale-90" svgName="SvgUserMinus" />
								<label class="select-none ml-1 font-medium text-gray-900">Remove Friend</label>
							</button>
						</ng-template>
						<ng-template #notFriendTemplate>
							<button
								(click)="openSendFriendRequestDialog()"
								class="cursor-default flex relative hover:bg-gray-200 my-1 py-1 rounded-md w-full items-center justify-between"
								matRipple
								type="button"
							>
								<svg-input class="scale-90" svgName="SvgUserPlus" />
								<label class="select-none ml-1 font-medium text-gray-900"
									>Send Friend Request</label
								>
							</button>
						</ng-template>
					</div>
					<div class="mt-4">
						<button
							(click)="closeMenu()"
							class="inline-flex min-w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto"
							type="button"
						>
							Cancel
						</button>
					</div>
				</div>
			</div>
		</div>
	</dialog-backdrop-template-component>
</ng-template>
