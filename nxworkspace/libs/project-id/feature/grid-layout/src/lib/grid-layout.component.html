<ng-container *ngIf="blocks$ | async as blocks">
  <canvas
    #canvas
    appCanvas
    [canvasRef]="canvas"
    [startDragging]="(clientXY$ | async)! as clientXY"
    class="border border-gray-400 pointer-events-none absolute z-10"
    style="width: 100%; height: 100%"
  >
  </canvas>
  <div cdkDropListGroup class="flex flex-col items-center">
    <div *ngFor="let n of numSequence(rows); let row = index" class="flex">
      <div *ngFor="let n of numSequence(cols); let col = index" class="border border-black">
        <ng-container *ngrxLet="row | getLocation: col; let location">
          <div
            (cdkDropListDropped)="gridStore.gridDrop($event)"
            (click)="gridStore.cellAction({location, event: $event})"
            (mousedown)="gridStore.mouseEvent({location, event: $event})"
            (mouseup)="gridStore.mouseEvent({location, event: $event})"
            [id]="location"
            cdkDropList
            class="flex justify-center items-center border-gray-400 bg-gray-200 w-8 h-8"
          >
            <ng-container *ngIf="blocks | getBlock: location as block">
              <ng-template appDynamic [block]="block"></ng-template>
            </ng-container>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</ng-container>
