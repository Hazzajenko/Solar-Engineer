<ng-container *ngIf='user$ | async as user'>
  <ng-container *ngIf='messages$ | async as messages'>
    <div class='flex flex-col items-center content-center'>
      <h1 mat-dialog-title>Messages</h1>

      <button class='flex flex-col items-center content-center' mat-button
              (click)='markAllMessagesAsRead(messages)'>
        Mark All As Read
      </button>
      <mat-checkbox [(ngModel)]='unreadFilter'>Filter by Unread</mat-checkbox>
      <mat-selection-list style='overflow: hidden' (selectionChange)='change($event)'
                          [multiple]='false'
                          class='flex flex-col items-center content-center'>
        <cdk-virtual-scroll-viewport style='height: 400px; width: 400px; overflow: hidden'
                                     itemSize='50'
                                     class='flex flex-col items-center content-center'>
          <!--          [ngStyle]='{"background-color": notification.status === 0 ? "#60a1fa" : ""}'-->
          <mat-list-option

            *cdkVirtualFor='let message of messages | sortMessages : unreadFilter'
            [value]='message'>

            <span matListItemTitle>{{message.senderUsername}}</span>
            <span matListItemLine>{{message.messageSentTime | date : 'short'}}</span>
            <p matListItemLine>{{message.content}}</p>

            <!--          [color]='notification.status === 0 ? "primary" : "accent"'-->
          </mat-list-option>
        </cdk-virtual-scroll-viewport>

      </mat-selection-list>


      <ng-container *ngIf='selectedMessage'>
        <button
          style='overflow: hidden'
          mat-button
          (click)='openConversation(selectedMessage)'>
          Open {{selectedMessage.senderUsername}} Conversation
        </button>
      </ng-container>
    </div>
    <!--    <button mat-button mat-dialog-close='true'>Exit</button>-->
  </ng-container>
</ng-container>