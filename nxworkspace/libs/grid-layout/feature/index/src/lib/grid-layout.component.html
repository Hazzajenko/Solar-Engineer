<ng-container *ngIf='blocks$ | async as blocks'>


  <div class='h-fit w-fit'>
    <canvas
      #canvas
      appCanvas
      [gridMode]='(gridMode$ | async)!'
      [startDragging]='(clientXY$ | async)!'
      [canvasOffsets]='offsets'
      class='border border-gray-400 pointer-events-none absolute z-10 h-fit w-fit max-w-fit max-h-fit'
      style='width: 100%; height: 100%; overflow: hidden; outline: 1px solid gray'
    >
    </canvas>
    <div id='zoom'>
      <div
        #appGrid
        appGrid
        [gridlayoutComponentXy]='gridLayoutXY'
        (elementOffsets)='offsets = $event'
        cdkDropListGroup
        style='width: 100%; height: 100%'
        class='appGrid flex flex-col items-center'
      >
        <!--        style='width: 680px; height: 680px; overflow: hidden'-->
        <!--        style='width: 1000px; height: 1000px'-->
        <!--        style='width: 100%; height: 100%'-->
        <!--      [ngStyle]="{'transform': 'scale(' + zoomLevel + ')'}"-->
        <!--      (mousedown)='mouseService.mouse({event: $event, location })'-->
        <!--      (click)='clickService.click({ event: $event, location })'

              (mouseup)='mouseService.mouse({event: $event, location })'
              (dblclick)='doubleClickService.doubleCLick({event: $event, location })'-->
        <!--      (mousemove)='move({event: $event, location })'-->
        <!--      (mousedown)='mouse({event: $event, location })'
              (mouseup)='mouse({event: $event, location })'-->
        <!--      (mousemove)='move({event: $event, location })'
              (mousedown)='mouse({event: $event, location })'
              (mouseup)='mouse({event: $event, location })'-->
        <div *ngFor='let n of numSequence(rows); let row = index' class='flex'>
          <div *ngFor='let n of numSequence(cols); let col = index' class='border border-black'>
            <ng-container *ngrxLet='row | getLocation: col; let location'>
              <div
                (cdkDropListDropped)='drop($event)'
                (click)='click({ event: $event, location })'
                (mousemove)='move({event: $event, location })'
                (mousedown)='mouse({event: $event, location })'
                (mouseup)='mouse({event: $event, location })'
                (dblclick)='doubleCLick({event: $event, location })'
                (dragover)='listDragOver($event, blocks)'
                [id]='location'
                cdkDropList
                class='flex justify-center items-center bg-gray-200 w-8 h-8'
              >
                <ng-container *ngIf='blocks | getBlock: location as block'>
                  <ng-template appDynamic [block]='block'></ng-template>
                </ng-container>
              </div>
            </ng-container>
          </div>
        </div>
        <!--      <ng-container *ngIf='showKeymap$ | async as keymap'>
                <app-keymap-overlay *ngIf='keymap'></app-keymap-overlay>
                <app-string-totals-overlay *ngIf='selectedString$ | async as selectedString'
                                           [selectedString]='selectedString'></app-string-totals-overlay>
              </ng-container>-->
      </div>
    </div>
  </div>
</ng-container>


